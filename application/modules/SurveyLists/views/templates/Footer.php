			<script src="<?php echo base_url('assets/js/jquery-3.3.1.min.js')?>"></script>
			<!-- <script>window.jQuery || document.write('<script src="<?php echo base_url('assets/src/js/vendor/jquery-3.3.1.min.js')?>"></script>')</script>
			<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
			<script>window.jQuery || document.write('<script src="../src/js/vendor/jquery-3.3.1.min.js"></script>')</script> -->
			<script src="<?php echo base_url('assets/plugins/popper.js/dist/umd/popper.min.js')?>"></script>
			<script src="<?php echo base_url('assets/plugins/bootstrap/dist/js/bootstrap.min.js')?>"></script>
			<script src="<?php echo base_url('assets/plugins/perfect-scrollbar/dist/perfect-scrollbar.min.js')?>"></script>
			<script src="<?php echo base_url('assets/plugins/screenfull/dist/screenfull.js')?>"></script>
			<script src="<?php echo base_url('assets/plugins/sweetalert/dist/sweetalert.min.js')?>"></script>
			<script src="<?php echo base_url('assets/plugins/summernote/dist/summernote-bs4.min.js')?>"></script>
			<script src="<?php echo base_url('assets/dist/js/theme.min.js')?>"></script>
			<script src="<?php echo base_url('assets/js/layouts.js')?>"></script>
			<script src="<?php echo base_url('assets/js/jquery-3.3.1.min.js')?>"></script>
			<script src="<?php echo base_url('assets/js/select2.min.js')?>"></script>

			<!-- <script src="<?php echo base_url() ?>assets/plugins/datapicker/bootstrap-datepicker.js"></script> -->
			<script src="<?php echo base_url('assets/js/datatables.js')?>"></script>
			<!-- <script src="<?php echo base_url() ?>assets/inspinia/js/jquery-2.1.1.js"></script> -->
			<script src="<?php echo base_url() ?>assets/inspinia/js/bootstrap.min.js"></script>
			<script src="<?php echo base_url() ?>assets/inspinia/js/plugins/metisMenu/jquery.metisMenu.js"></script>
			<script src="<?php echo base_url() ?>assets/inspinia/js/plugins/slimscroll/jquery.slimscroll.min.js"></script>
			<!-- Custom and plugin javascript -->
			<script src="<?php echo base_url() ?>assets/inspinia/js/inspinia.js"></script>
			<script src="<?php echo base_url() ?>assets/inspinia/js/plugins/pace/pace.min.js"></script>
			<script src="<?php echo base_url() ?>assets/inspinia/js/plugins/datapicker/bootstrap-datepicker.js"></script>
			<script src="<?php echo base_url() ?>assets/inspinia/js/plugins/sweetalert/sweetalert.min.js"></script>
			
			<script src="<?php echo base_url() ?>assets/inspinia/js/plugins/select2/select2.full.min.js"></script>
			<script src="<?php echo base_url() ?>assets/js/moment.js"></script>
			<script src="<?php echo base_url() ?>assets/js/bootstrap-datetimepicker.min.js"></script>
			<script src="<?php echo base_url() ?>assets/js/bootstrap-select.min.js"></script>
			
			<script src="<?php echo base_url('assets/plugins/datatables.net/js/jquery.dataTables.min.js');?>"></script>
			<script src="<?php echo base_url('assets/plugins/datatables.net-bs4/js/dataTables.bootstrap4.min.js');?>"></script>
			<script src="<?php echo base_url('assets/js/datatables.js');?>"></script>
			<script src="<?php echo base_url(); ?>assets/inspinia/js/plugins/sweetalert/sweetalert.min.js"></script>

			<!-- HTML5 EXPORT -->
			<script src="<?php echo base_url('assets/js/dataTables.buttons.min.js');?>"></script>
			<script src="<?php echo base_url('assets/js/jszip.min.js');?>"></script>
			<script src="<?php echo base_url('assets/js/pdfmake.min.js');?>"></script>
			<script src="<?php echo base_url('assets/js/vfs_fonts.js');?>"></script>
			<script src="<?php echo base_url('assets/js/buttons.html5.min.js');?>"></script>
			<!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->

			<script src="<?php echo base_url('assets/js/chart-flot.js');?>"></script>
    	<script src="<?php echo base_url('assets/plugins/amcharts/amcharts.js');?>"></script>
    	<script src="<?php echo base_url('assets/plugins/amcharts/gauge.js');?>"></script>
    	<script src="<?php echo base_url('assets/plugins/amcharts/serial.js');?>"></script>
    	<script src="<?php echo base_url('assets/plugins/amcharts/themes/light.js');?>"></script>
    	<script src="<?php echo base_url('assets/plugins/amcharts/animate.min.js');?>"></script>
    	<script src="<?php echo base_url('assets/plugins/amcharts/pie.js');?>"></script>
    	<script src="<?php echo base_url('assets/plugins/ammap3/ammap/ammap.js');?>"></script>
    	<script src="<?php echo base_url('assets/plugins/ammap3/ammap/maps/js/usaLow.js');?>"></script>

			<!-- SCRIPT DEMOGRAPHIC AGE --ir -->
			<script src="<?php echo base_url('assets/js/amcharts/core.js');?>"></script>
			<script src="<?php echo base_url('assets/js/amcharts/charts.js');?>"></script>
			<script src="<?php echo base_url('assets/js/amcharts/wordCloud.js');?>"></script>
			<script src="<?php echo base_url('assets/js/amcharts/animated.js');?>"></script>

			<!-- TAGS INPUT --ir -->
			<script src="<?php echo base_url('assets/js/tags/tagsinput.js');?>"></script>

			<script>
			    (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
			    function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
			    e=o.createElement(i);r=o.getElementsByTagName(i)[0];
			    e.src='https://www.google-analytics.com/analytics.js';
			    r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
			    ga('create','UA-XXXXX-X','auto');ga('send','pageview');
			</script>
			<script>
				$('#surveyBegin, #surveyEnd').datepicker({
      	  // minViewMode: 1,
      	  keyboardNavigation: false,
      	  forceParse: false,
      	  autoclose: true,
      	  todayHighlight: true,
      	  // endDate: 'd',
      	  format: "yyyy-mm-dd"
				});

				
				// SET MACHINE AVAILABILITY VALUES --ir
  			// function respValue(value) {
				// 	// CHART MACHINE AVAILABILITY --ir 
				// 	var respChart = AmCharts.makeChart("getPieTerminalSurvey1", {
  			// 	  "type": "gauge",
  			// 	  "theme": "none",
  			// 	  "axes": [{
  			// 	    "axisThickness": 1,
  			// 	    "axisAlpha": 0.2,
  			// 	    "tickAlpha": 0.2,
  			// 	    "valueInterval": 20,
  			// 	    "bands": [
  			// 	      {
  			// 	        "color": "#D7263D",
  			// 	        "endValue": 150,
  			// 	        "startValue": 0
  			// 	      }, {
  			// 	        "color": "#F7971E",
  			// 	        "endValue": 400,
  			// 	        "startValue": 150
  			// 	      }, {
  			// 	        "color": "#1a7bb9",
  			// 	        "endValue": 500,
  			// 	        "innerRadius": "95%",
  			// 	        "startValue": 400
  			// 	      }
  			// 	    ],
  			// 	    "bottomText": "0 Responses",
  			// 	    "bottomTextYOffset": -20,
  			// 	    "endValue": 500
  			// 	  }],
  			// 	  "arrows": [{}],
  			// 	  "export": {
  			// 	    "enabled": true
  			// 	  }
  			// 	});

  			//   if (respChart) {
  			//     if (respChart.arrows) {
  			//       if (respChart.arrows[0]) {
  			//         if (respChart.arrows[0].setValue) {
  			//           respChart.arrows[0].setValue(value);
  			//           respChart.axes[0].setBottomText(value + " Responses");
  			//           // respChart.axes[0].setEndValue(1000);
  			//         }
  			//       }
  			//     }
  			//   }
  			// }

				// CHART FOR SURVEY PENUMPANG DAN MASYARAKAT --ir
				var generalChart
				var chartsA = {
					graphAge : {
						'chart'			: {
							'graphAge'		: {
								'chartCol'		: '12',
								'title'				: '',
								'subtitle'		: '',
							},
						}, 
						'cardCol'		: '6',
						'button'		: ' Demografis Usia',
						'title'			: 'Demografis Responden berdasarkan usia',
						'subtitle'	: '',
					},
					typeOfResp : {
						'chart'			: {
							'typeOfResp'	: {
								'chartCol'		: '12',
								'title'				: '',
								'subtitle'		: '',
							},
						}, 
						'cardCol'		: '6',
						'button'		: ' Frekuensi Penggunaan Bus',
						'title'			: 'Frekuensi penggunaan moda transportasi bus',
						'subtitle'	: '',
					},
					ratingChart : {
						'chart'			: {
							'ratingChart'	: {
								'chartCol'		: '12',
								'title'				: '',
								'subtitle'		: '',
							},
						}, 
						'cardCol'		: '12',
						'button'		: ' Skor Penilaian Transportasi',
						'title'			: 'Skor penilaian di setiap moda transportasi',
						'subtitle'	: '(Dalam %)',
					},
					satisfaction : {
						'chart'			: {
							'satisfaction': {
								'chartCol'		: '12',
								'title'				: '',
								'subtitle'		: '',
							},
						}, 
						'cardCol'		: '12',
						'button'		: ' Rating Kepuasan Pelayanan Terminal',
						'title'			: 'Rating tingkat kepuasan pelayanan terminal dan PO Bus',
						'subtitle'	: '(Dalam %)',
					},
					tagCloud : {
						'chart'			: {
							'tagCloud'		: {
								'chartCol'		: '12',
								'title'				: '',
								'subtitle'		: '',
							},
						}, 
						'cardCol'		: '12',
						'button'		: ' Citra Terminal dan Transportasi Bus',
						'title'			: 'Citra Terminal dan Moda Transportasi Bus',
						'subtitle'	: '(Words Cloud)',
					},
					tagCloud2 : {
						'chart'			: {
							'tagCloud2'		: {
								'chartCol'		: '12',
								'title'				: '',
								'subtitle'		: '',
							},
						}, 
						'cardCol'		: '12',
						'button'		: ' Citra PO Bus',
						'title'			: 'Citra PO Bus di mata masyarakat',
						'subtitle'	: '(Words Cloud)',
					},
					moneySpent : {
						'chart'			: {
							'moneySpent'	: {
								'chartCol'		: '12',
								'title'				: '',
								'subtitle'		: '',
							},
						}, 
						'cardCol'		: '6',
						'button'		: ' Biaya yang dihabiskan untuk Internet',
						'title'			: 'Biaya yang dihabiskan untuk kuota internet',
						'subtitle'	: '',
					},
					freqApp : {
						'chart'			: {
							'freqApp'		: {
								'chartCol'		: '12',
								'title'				: '',
								'subtitle'		: '',
							},
						}, 
						'cardCol'		: '6',
						'button'		: ' Frekuensi Penggunaan Aplikasi',
						'title'			: 'Frekuensi penggunaan aplikasi untuk bertransaksi',
						'subtitle'	: '',
					},
					tagCloudHope : {
						'chart'			: {
							'tagCloudHope': {
								'chartCol'		: '12',
								'title'				: '',
								'subtitle'		: '',
							},
						}, 
						'cardCol'		: '12',
						'button'		: ' Harapan untuk Terminal',
						'title'			: 'Harapan terkait terminal di masa mendatang',
						'subtitle'	: '(Words Cloud)',
					},
					tagCloudHope2 : {
						'chart'			: {
							'tagCloudHope2': {
								'chartCol'		: '12',
								'title'				: '',
								'subtitle'		: '',
							},
						}, 
						'cardCol'		: '12',
						'button'		: ' Harapan untuk Transportasi Bus',
						'title'			: 'Harapan terkait moda transportasi di masa mendatang',
						'subtitle'	: '(Words Cloud)',
					},
					tagCloudHope3 : {
						'chart'			: {
							'tagCloudHope3': {
								'chartCol'		: '12',
								'title'				: '',
								'subtitle'		: '',
							},
						}, 
						'cardCol'		: '12',
						'button'		: ' Harapan terkait penerapan Digitalisasi di Terminal',
						'title'			: 'Harapan terkait penerapan teknologi/digitalisasi di terminal di masa mendatang',
						'subtitle'	: '(Words Cloud)',
					},
				}
				
				// CHART FOR SURVEY INTERNAL ORGANISASI --ir
				var chartsB = {
					fiveValue : {
						'chart'			: {
							'fiveValue2'	: {
								'chartCol'		: '12',
								'title'				: '',
								'subtitle'		: '',
							},
							'fiveValue'	: {
								'chartCol'		: '12',
								'title'				: '',
								'subtitle'		: '',
							},
						}, 
						'button'		: ' Strategi Kompetensi Internal Organisasi',
						'cardCol'		: '12',
						'title'			: 'Strategi Kompetensi',
						'subtitle'	: '(Dalam %)',
					},
					vehicle : {
						'chart'			: {
							'vehicle'		: {
								'chartCol'		: '12',
								'title'				: '',
								'subtitle'		: '',
							},
						}, 
						'cardCol'		: '4',
						'button'		: ' Kondisi Eksisting (Kendaraan)',
						'title'			: 'Jumlah Izin Kendaraan',
						'subtitle'	: '',
					},
					route : {
						'chart'			: {
							'route'			: {
								'chartCol'		: '12',
								'title'				: '',
								'subtitle'		: '',
							},
						}, 
						'cardCol'		: '4',
						'button'		: ' Kondisi Eksisting (Trayek)',
						'title'			: 'Jumlah Trayek',
						'subtitle'	: '',
					},
					request : {
						'chart'			: {
							'request'		: {
								'chartCol'		: '12',
								'title'				: '',
								'subtitle'		: '',
							},
						}, 
						'cardCol'		: '4',
						'button'		: ' Kondisi Eksisting (Keberangkatan & Kedatangan)',
						'title'			: 'Permintaan keberangkatan dan kedatangan angkutan',
						'subtitle'	: '',
					},
				}
				
				// CHART FOR SURVEY PO BUS --ir
				var chartsC = {
					fiveValuePO : {
						'chart'			: {
							'fiveValuePO2'	: {
								'chartCol'		: '12',
								'title'				: '',
								'subtitle'		: '',
							},
							'fiveValuePO'	: {
								'chartCol'		: '12',
								'title'				: '',
								'subtitle'		: '',
							},
						}, 
						'button'		: ' Strategi Kompetensi PO BUS',
						'cardCol'		: '12',
						'title'			: 'Strategi Kompetensi',
						'subtitle'	: '(Dalam %)',
					},
					tagConditionPO : {
						'chart'			: {
							'vehiclePO'		: {
								'chartCol'		: '6',
								'title'				: 'Jumlah Izin Kendaraan',
								'subtitle'		: '',
							},
							'routePO'		: {
								'chartCol'		: '6',
								'title'				: 'Jumlah Trayek',
								'subtitle'		: '',
							},
						}, 
						'cardCol'		: '6',
						'button'		: ' Kondisi Eksisting (Kendaraan & Trayek)',
						'title'			: 'Kondisi Eksisting',
						'subtitle'	: '(Kendaraan & Trayek)',
					},
					tagConditionPO2 : {
						'chart'			: {
							'departurePO'		: {
								'chartCol'		: '6',
								'title'				: 'Permintaan keberangkatan angkutan',
								'subtitle'		: '',
							},
							'arrivalPO'		: {
								'chartCol'		: '6',
								'title'				: 'Permintaan kedatangan angkutan',
								'subtitle'		: '',
							},
						}, 
						'cardCol'		: '6',
						'button'		: ' Kondisi Eksisting (Keberangkatan & Kedatangan)',
						'title'			: 'Kondisi Eksisting',
						'subtitle'	: '(Keberangkatan & Kedatangan)',
					},
					tagConditionPO3 : {
						'chart'			: {
							'occupancyPO'		: {
								'chartCol'		: '6',
								'title'				: 'Tingkat Keterisian Penumpang',
								'subtitle'		: '',
							},
							'decreasePO'		: {
								'chartCol'		: '6',
								'title'				: 'Penurunan Penumpang selama 3 tahun',
								'subtitle'		: '(Sebelum Covid-19)',
							},
						}, 
						'cardCol'		: '12',
						'button'		: ' Kondisi Eksisting (Keterisian & Penurunan Penumpang)',
						'title'			: 'Kondisi Eksisting',
						'subtitle'	: '(Keterisian & Penurunan Penumpang)',
					},
				}

				$(document).ready(function() {
					toggleShow(false)
					setSurveyLists()
					$('#goBack, #surveyTitle, #surveyDesc, #tableResponses, #deptProc').hide()
					$('.titleModule').empty().html("SURVEY LISTS")

				});

				// CONVERT DATE TO FULL DATE --ir 
				function convertDate(d) {
					var weekday 	= ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"]
					var monthList = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"]
					var date = new Date(d)
					date = weekday[date.getDay()]+", "+("0"+date.getDate()).slice(-2)+" "+monthList[date.getMonth()]+" "+date.getFullYear()
					return date
				}

				// CONVERT NULL TO BLANK --ir
  			function nullToBlank(value) {
					return !(value) ? "" : value;
				}
			
				// CALL FUNCTION SELECT PICKER --ir
  			function select(){
  			  $(function() {
  			    $('.selectpicker').selectpicker();
  			  });
  			}
			
  			// RESET SELECTPICKER --ir
  			function refreshSelect(){
  			  $(function() {
  			    $('.selectpicker').selectpicker('refresh');
  			  });
  			}

				// CLEAR INPUT --ir 
				function clear() {
					$('#infoSurveys').empty()
				}

				// SHOW/HIDE TABLES --ir
				function toggleShow(bol) {
					if (bol) {
						$('#headPages').show()
					}else{
						$('#headPages').hide()
					}
				}

				function showSurveys() {
					toggleShow(false);
					doNotRemoveMe = $('#chartResponses').find('.doNotRemoveMe')
					$('.listBtnCharts').empty()
					$('#chartResponses').empty()
					$('#chartResponses').html(doNotRemoveMe);

					$('#graphAgeBody, #typeOfRespBody').hide()
					$('#idPage').val('')
					$('#tableSurveys').show()
					$('#tableResponses, #chartResponses, #goBack, #surveyTitle, #surveyDate, #surveyURL').hide()
					$('#typeOfRespBody, #ratingChartBody, #satisfactionBody, #tagCloudBody, #tagCloud2Body, #freqAppBody, #moneySpentBody, #tagCloudHopeBody, #tagCloudHope2Body, #tagCloudHope3Body, #fiveValueBody, #vehicleBody, #routeBody, #requestBody, #fiveValuePOBody, #tagConditionPOBody, #tagConditionPO2Body, #tagConditionPO3Body').hide()
					$('#surveyTitle, #surveyDate, #surveyURL').empty()
				}

				// CHANGE SURVEY AND SET THE STEPS
				function setSurveyLists() {
					toggleShow(false)
					showSurveys()
					clear()

					$('#tableSurveyLists').DataTable().destroy()
					tableSurveyLists = $('#tableSurveyLists').DataTable({
						"autoWidth": false,
        		dom: 'Bfrtip',
        		buttons: [
        		  'copyHtml5',
        		  'excelHtml5',
        		]
					})
					tableSurveyLists.clear().draw()

					$.ajax({
      	    url : '<?php echo base_url('General/surveyLists') ?>',
      	    type: "post",
      	    // data: {author:author},
      	    dataType: "JSON",
      	    success : function(data){
							$.each(data, function() {
								if(nullToBlank(this.status) == "0"){
									btn = 'warning'
									text = 'Unpublished'
								}else{
									btn = 'info'
									text = 'Published'
								}

								status = "<center><button style='width:100%' onclick='changeStatus(\"survey\", \""+this.id+"\", \""+nullToBlank(this.status)+"\")' class = 'btn btn-"+btn+" btn-md' value='"+nullToBlank(this.status)+"'>"+text+"</button></center>"
								title  = "<center><a style='width:100%' href='"+window.location.origin+"/takeda/Survey?id="+this.id+"' class = 'btn btn-primary btn-md' value='"+nullToBlank(this.id)+"'>"+nullToBlank(this.title)+"</a></center>"
								action = "<center><span class='actionSpan'>"
								action += "<button id='btnViewResponses' onclick='showResponses(\""+this.id+"\",\""+this.title+"\", \""+nullToBlank(this.beginDate)+"\", \""+nullToBlank(this.endDate)+"\", \""+nullToBlank(this.url)+"\", \""+nullToBlank(this.status)+"\")' class = 'btn btn-info btn-md' ><i class='fa fa-comment-dots'></i></button>"
								action += "<button id='btnViewCharts' onclick='viewCharts(\""+this.id+"\", \""+this.title+"\", \""+nullToBlank(this.beginDate)+"\", \""+nullToBlank(this.endDate)+"\", \""+nullToBlank(this.url)+"\", \""+nullToBlank(this.status)+"\")' class = 'btn btn-success btn-md' ><i class='fa fa-chart-bar'></i></button>"
								action += "<a id='btnEditSurvey' href='"+window.location.origin+"/takeda/MstSurvey?id="+this.id+"' class = 'btn btn-warning btn-md' ><i class='fa fa-edit'></i></a>"
								action += "<button id='btnDelSurvey' onclick='delRow(\"survey\", \""+this.id+"\", \""+nullToBlank(this.title)+"\")' class = 'btn btn-danger btn-md' ><i class='fa fa-trash'></i></button>"
								action += "</span></center>"
								lastResponse = '<center>'+this.lastResponse+'</center>'
								responses = '<center>'+this.responses+'</center>'

								row = []
								row.push(status, title, responses, convertDate(this.date), lastResponse, action)
								tableSurveyLists.row.add(row).draw()
							})
							$('.actionSpan').find('button').css({'margin' : '3px', 'width' : '40px'})
							$('.actionSpan').find('a').css({'margin' : '3px', 'width' : '40px'})
							// tableSurveyLists.css({'vertical-align' : 'middle'})
      	    },
      	    beforeSend: function(){
      	    },complete: function(){
      	    },error: function() {
						}
      	  })
				}

				// FUNCTION CHANGE STATUS SURVEY --ir
      	function changeStatus(type, id, status){
					idSurvey 	= $('#id').val()
					idPage 		= $('#idPage').val()
					if(type == "survey"){
						if(status == "0") text = "Publish"
						else text = "Revoke"
					}else{
						if(status == "0") text = "show"
						else text = "hide"
					}

					swal({
						title 						 : "Hold Up!",
						text 							 : "Are you sure to "+text+" this "+type+"?",
						type							 : "warning",
						showCancelButton 	 : true,
						confirmButtonClass : "btn-info",
						confirmButtonText	 : "Yes, "+text.toLowerCase()+" this "+type+"!", 
						cancelButtonText	 : "No, nevermind!",
						closeOnConfirm		 : false,
						closeOnCancel			 : false
					},
					function(isConfirm) {
						if (isConfirm) {
							$.ajax({
      	  		  url : '<?php echo base_url('MstSurvey/changeStatus') ?>',
      	  		  type: "post",
      	  		  data: {type:type, id:id, status:status},
      	  		  dataType: "JSON",
      	  		  success : function(data){
									if(data=='success'){
										text = "Success "+text.toLowerCase()+" this "+type+"!";
										title = "Success"
									}else{
										text = "Failed "+text.toLowerCase()+" this "+type+"!";
										title = "Warning"
									}
      	  		  },
      	  		  beforeSend: function(){
								
      	  		  },complete: function(){
									swal({title : title, text  : text, type	: title.toLowerCase()}) 
									if(title === "Success"){
										setSurveyLists()
									} 
      	  		  },error: function() {

								}
      	  		})
						}else{
							swal("Canceled", "This "+type+" will not be "+text.toLowerCase()+"!", "success");
						}	
					})
				}

				// CALL MODAL CREATE SURVEY --ir
				function modalCreateSurvey(){
			    // if(!check('save')) return false
      	  $('#modalSurvey').show()
					$('.modal-title').html("Add Survey")
					$('#action').val("create")
				}

				// CLOSE MODAL --ir 
				function closeModal(){
					// $('#id').val('');
					$('#title').val('')
					$('#surveyBegin').val('')
					$('#surveyEnd').val('')
					$('#url').val('')
					$('#action').val('')
      	  $('#modalSurvey').hide()
				}

				// FUNCTION CREATE OR UPDATE SURVEY --ir
      	function updateSurvey(){
					var id					= $('#id').val()
					var title	 			= $('#title').val()
					var surveyBegin	= $('#surveyBegin').val()
					var surveyEnd		= $('#surveyEnd').val()
					var url					= $('#url').val()
					var target			= $('#target').val()
					var action 			= $('#action').val()
					if(action == "update") text = "Update"
					else text = "Add"

					swal({
						title 						 : text+" this?",
						type							 : "warning",
						showCancelButton 	 : true,
						confirmButtonClass : "btn-info",
						confirmButtonText	 : "Yes, "+text.toLowerCase()+" this!", 
						cancelButtonText	 : "No, nevermind!",
						closeOnConfirm		 : false,
						closeOnCancel			 : false
					},
					function(isConfirm) {
						if (isConfirm) {
							$.ajax({
      	  		  type		: "POST",
      	  		  dataType: "JSON",
      	  		  url 		: '<?php echo base_url('MstSurvey/updateSurvey') ?>',
      	  		  data		: {id:id, action:action, title:title, surveyBegin:surveyBegin, surveyEnd:surveyEnd, url:url, target:target},
      	  		  success : function(data){
      	  		    if(data=='success'){
										if (action === "create") text = "Success adding a new survey!";
										else text = "Success update survey!";
										title = "Success"
      	  		    }else if(data=="duplicate"){
										text = "Survey "+title+" is already existed!";
										title = "Warning"
      	  		    }else{
										if (action === "create") text = "Failed to add a new survey!";
										else text = "Failed to update survey!";
										title = "Warning"
      	  		    }
      	  		  },
      	  		  beforeSend: function(){
								
      	  		  },complete: function(){
									closeModal();
									swal({title : title, text  : text, type	: title.toLowerCase()}) 
									if(title==="Success"){
										setSurveyLists()
									} 
      	  		  },
      	  		});
						}else{
							swal("Canceled", "Cancel "+text.toLowerCase()+"!", "success");
						}	
					})
      	}
				
				// SHOW TABLE QUESTIONS --ir
				function showResponses(id, title, beginDate, endDate, url, status) {
					$('#idPage').val(idPage)
					$('#tableSurveys, #chartResponses').hide()
					$('#tableResponses, #goBack, #surveyTitle, #surveyDate, #surveyURL').show()
					// $('#surveyTitle').html("<b>"+title+"</b>")
					// $('#surveyDesc').html('')

					$('#surveyTitle').html('Title &emsp;&emsp;&emsp;: <b>'+nullToBlank(title)+'</b>')
					if(nullToBlank(beginDate) && nullToBlank(endDate) && nullToBlank(beginDate) != "0000-00-00" && nullToBlank(endDate) != "0000-00-00") $('#surveyDate').html('Start/End Survey &ensp;: &nbsp;<b>'+nullToBlank(convertDate(beginDate))+'</b> to <b>'+nullToBlank(convertDate(endDate))+"</b>")
					if(url){
						$('#surveyURL').append('Redirected to &emsp;&emsp;: &nbsp;<a></a>')
					 	$('#surveyURL').find('a').attr('href', url)
						$('#surveyURL').find('a').html(url)
					} 
					$('.infoSurvey').css({'margin' : '5px'})
					$('#surveyTitle').css({'margin-top' : '15px'})

					setResponses(id)
				}


				function setTerminal(id) {
  			  $('#basedQ').find('option').remove().end().append('<option value="">All Terminal</option>')
					$.ajax({
  			    url 			: '<?php echo base_url('SurveyLists/listTerminal') ?>',
  			    type			: "post",
      	    data			: {id:id},
  			    dataType	: "JSON",
  			    success: function(data) {
  			      // REMOVE ALL OPTIONS --ir
  			      // APPEND RELVANT OPTIONS --ir
							$.each(data, function(key, val) {
								id 		= val.id
								title 	= val.title
  			        $('#basedQ').append('<option value = '+id+'>' +title+'</option>')
							})
  					},	
  			    error: function() {
  			      swal({title : "Failed", text  : "Failed to load terminal!", type	: "error"})
  			    }, 
  			    complete: function() {
							// changeTerminal()
							getDataChart('Responden')
							// getDataChart(chart)
  			    } 
  			  })
				}

				//  ONCHANGE MACHINE DROPDOWN --ir
  			function changeTerminal() {
					basedQ = $('#basedQ').val()
					id 			 = $('#id').val()
					// alert(id)
					
  			  // GET VALUE RESPONDENS ON THIS TERMINAL --ir 
				  $.ajax({
						type: "POST",
				  	url: '<?php echo base_url().'SurveyLists/changeTerminal/'; ?>',
  			    data: {basedQ:basedQ, id:id},
				  	dataType: "json",
				  	success: function(data) {
							// $('#graphAgeBody').show()
							minResp = 0;
							maxResp = 500;
							grades = [
				  		  {
				  		    title: "Kurang dari "+((maxResp / 4) * 1)+" Responden",
				  		    color: "#ee1f25",
				  		    lowScore: minResp,
				  		    highScore: ((maxResp / 4) * 1)-1
				  		  },
				  		  {
				  		    title: "Kurang dari "+((maxResp / 4) * 2)+" Responden",
				  		    color: "#fdae19",
				  		    lowScore: ((maxResp / 4) * 1),
				  		    highScore: ((maxResp / 4) * 2)-1
				  		  },
				  		  {
				  		    title: "Lebih dari "+((maxResp / 4) * 2)+" Responden",
				  		    color: "#b0d136",
				  		    lowScore: ((maxResp / 4) * 2)+1,
				  		    highScore: ((maxResp / 4) * 3)
				  		  },
				  		  {
				  		    title: "Lebih dari "+((maxResp / 4) * 3)+" Responden",
				  		    color: "#0f9747",
				  		    lowScore: ((maxResp / 4) * 3)+1,
				  		    highScore: ((maxResp / 4) * 4)
				  		  },
				  		]

  			      // respValue(0);
  			      gaugeBands(data.getResponden, grades, minResp, maxResp);
							graphAge(data.getGraphAge)
							// $('#graphAgeBody').removeClass()
							if(id == "27"){
							// $('#graphAgeBody').addClass('col-md-6')
								typeOfResp(data.getTypeOfResp)
								ratingChart(data.getRatingChart)
								satisfaction(data.getSatisfaction)
								tagCloud(data.getTagCloud)
								tagCloud2(data.getTagCloud2)
								freqApp(data.getFreqApp)
								moneySpent(data.getmoneySpent)
								tagCloudHope(data.getTagCloudHope)
								tagCloudHope2(data.getTagCloudHope2)
								tagCloudHope3(data.getTagCloudHope3)

								console.log(data.getTypeOfResp)
								console.log(data.getRatingChart)
								console.log(data.getSatisfaction)
								console.log(data.getTagCloud)
								console.log(data.getTagCloud2)
								console.log(data.getFreqApp)
								console.log(data.getmoneySpent)
								console.log(data.getTagCloudHope)
								console.log(data.getTagCloudHope2)
								console.log(data.getTagCloudHope3)
								// $('#typeOfRespBody, #ratingChartBody, #satisfactionBody, #tagCloudBody, #tagCloud2Body, #freqAppBody, #moneySpentBody, #tagCloudHopeBody, #tagCloudHope2Body, #tagCloudHope3Body').show()
							}else if(id == "28"){
								fiveValue(data.getFiveValue)
								fiveValue2(data.getFiveValue)
								vehicle(data.getVehicle)
								route(data.getRoute)
								request(data.getRequest)

								console.log(data.getFiveValue)
								console.log(data.getVehicle)
								console.log(data.getRoute)
								console.log(data.getRequest)
								// $('#fiveValueBody').show()
								// $('#vehicleBody').show()
								// $('#routeBody').show()
								// $('#requestBody').show()
								// $('#graphAgeBody').addClass('col-md-12')
							}else if(id == "29"){
								fiveValuePO(data.getFiveValuePO)
								fiveValuePO2(data.getFiveValuePO)
								vehiclePO(data.getVehiclePO)
								routePO(data.getRoutePO)
								departurePO(data.getDeparturePO)
								arrivalPO(data.getArrivalPO)
								occupancyPO(data.getOccupancyPO)
								decreasePO(data.getDecreasePO)

								console.log(data.getFiveValuePO)
								console.log(data.getVehiclePO)
								console.log(data.getRoutePO)
								console.log(data.getDeparturePO)
								console.log(data.getArrivalPO)
								console.log(data.getOccupancyPO)
								console.log(data.getDecreasePO)
								// $('#fiveValuePOBody').show()
								// $('#tagConditionPOBody').show()
								// $('#tagConditionPO2Body').show()
								// $('#tagConditionPO3Body').show()
								// $('#graphAgeBody').addClass('col-md-12')
							}else return true 
  			    },	
  			    error: function() {
  			      // alert('Load Responden Failed!');
  			      // gaugeBands(0);
							graphAge('')
							if(id == "27"){
								typeOfResp('')
								ratingChart('')
								satisfaction('')
								tagCloud('')
								tagCloud2('')
								freqApp('')
								moneySpent('')
								tagCloudHope('')
								tagCloudHope2('')
								tagCloudHope3('')
							}else if(id == "28"){
								fiveValue('')
								fiveValue2('')
								vehicle('')
								route('')
								request('')
							}else return true 
  			    }
  			  });
  			}

				// DELETE SURVEY/PAGE/QUESTION/ANSWER --ir
				function delRow(type, id, title) {
					// if(!check('del')) return false
					swal({
						title 						 : "Hold on!",
						text 							 : "Are you sure to delete "+type+" "+title+"? You cannot recover this!",
						type							 : "warning",
						showCancelButton 	 : true,
						confirmButtonClass : "btn-danger",
						confirmButtonText	 : "Yes, delete that!", 
						cancelButtonText	 : "No, nevermind!",
						closeOnConfirm		 : false,
						closeOnCancel			 : false
					},
					function(isConfirm) {
						if (isConfirm) {
							$.ajax({
								type			:	"post",
								url				:	"<?php echo base_url('MstSurvey/delRow') ?>",
								data 			: {type:type, idSurvey:id},
								dataType	: "JSON",
								success 	: function(data){
									if(data == "success"){
										swal({title : "Success", text : "Success delete "+type+" "+title+"!", type : "success"})
									}else{
										swal({title : "Failed", text : "Failed to delete "+type+" "+title+"!", type : "error"})
									}
								},complete: function(){
									setSurveyLists()
      	  		  },
							});
						}else{
							swal("Canceled", "Your "+type+" is safe!", "success");
						}	
					});
				}

				// CHART MENU -- ir

					// SHOW CHART RESPONSES --ir
					function viewCharts(id, title, beginDate, endDate, url, status) {
						$('#id').val(id)
						// if(id != "27" && id != "28" && id != "29" ) return false
						$('#idPage').val(idPage)
						$('#tableSurveys').hide()
						$('#chartResponses, #goBack, #surveyTitle, #surveyDate, #surveyURL').show()
						getDataOptChart()

						$('#surveyTitle').html('Title &emsp;&emsp;&emsp;: <b>'+nullToBlank(title)+'</b>')
						if(nullToBlank(beginDate) && nullToBlank(endDate) && nullToBlank(beginDate) != "0000-00-00" && nullToBlank(endDate) != "0000-00-00") $('#surveyDate').html('Start/End Survey &ensp;: &nbsp;<b>'+nullToBlank(convertDate(beginDate))+'</b> to <b>'+nullToBlank(convertDate(endDate))+"</b>")
						if(url){
							$('#surveyURL').append('Redirected to &emsp;&emsp;: &nbsp;<a></a>')
						 	$('#surveyURL').find('a').attr('href', url)
							$('#surveyURL').find('a').html(url)
						} 
						$('.infoSurvey').css({'margin' : '5px'})
						$('#surveyTitle').css({'margin-top' : '15px'})
						toggleShow(true)

						setChartCards(id)					
						// console.log(setChartCards(id))

						// setTerminal(id)
					}

					// DELETE CHART FROM CHART LISTS --ir
					function removeChart(idChart) {
						id = $('#id').val()
						swal({
							title 						 : "Hold Up!",
							text 							 : "Are you sure to delete this chart?",
							type							 : "warning",
							showCancelButton 	 : true,
							confirmButtonClass : "btn-info",
							confirmButtonText	 : "Yes, delete this!", 
							cancelButtonText	 : "No, nevermind!",
							closeOnConfirm		 : false,
							closeOnCancel			 : false
						},
						function(isConfirm) {
							if (isConfirm) {
								$.ajax({
									url			 : '<?php echo base_url('General/dbDeleteRow') ?>',
									type 		 : 'post',
									dataType : 'JSON',
									data 	 	 : {table:"do_charts", where:"id = '"+idChart+"'"},
									success  : function(data) {
									},
									error: function() {
  				  		    swal({title : "Failed", text  : "Failed to delete charts!", type	: "error"})
  				  		  }, 
									complete: function() {
  				  		    swal({title : "Success", text  : "Success to delete charts!", type	: "success"})
										setChartCards(id)
  				  		  } 
								})
							}else{
  				      swal({title : "Canceled", text  : "Your chart is safe!", type	: "success"})
							}
						})
					}

					// FUNCTION SHOW OR HIDE ALL CHARTS --ir
					function showHideAllCharts(act) {
						if(act == "show") val = 0
						else val = 1
						$('.listBtnCharts').find(".btnChart").each(function(i) {
						  var btn = $(this);
							btn.val(val)
						  setTimeout(btn.trigger.bind(btn, "click"), i * 1000);
						});
					}

					// FUNCTION SHOW OR HIDE CHARTS --ir
					function showBtnChart(idChart, typeChart, basedQ) {
						btn = $('#chart'+idChart+'Button').val()
						chartVal = $('#'+idChart+'Body').attr('name')
						if(btn == "0"){
							$('#chart'+idChart+'Body').show()	
							$('#chart'+idChart+'Button').val("1")
							$('#chart'+idChart+'Body').attr("name", "1")
							$('#chart'+idChart+'Button').removeClass("btn-info")
							$('#chart'+idChart+'Button').addClass("btn-danger")

							getDataChart(typeChart, "custom", idChart, basedQ)

							var container = $('#chartResponses'),
							    scrollTo 	= $('#chart'+idChart+'Body')

							window.scrollTo({ top: scrollTo.offset().top - container.offset().top + container.scrollTop() + 200, behavior: 'smooth' });
						}else{
							$('#chart'+idChart+'Body').hide()
							$('#chart'+idChart+'Button').val("0")
							$('#chart'+idChart+'Button').removeClass("btn-danger")
							$('#chart'+idChart+'Button').addClass("btn-info")
						}
					}

					// SET CHART LISTS SURVEY --ir
					function setChartCards(id, idChart, typeChart, basedQ) {
						$.ajax({
							url			 : '<?php echo base_url('General/dbResult') ?>',
							type 		 : 'post',
							dataType : 'JSON',
							data 	 	 : {table:"do_charts", column:"*", where:"survey = '"+id+"'", order:""},
							success  : function(data) {
								doNotRemoveMe = $('#chartResponses').find('.doNotRemoveMe')
								$('.listBtnCharts').empty()
								$('#chartResponses').empty()
								$('#chartResponses').html(doNotRemoveMe);
								// $('.listBtnCharts').empty()
								$.each(data, function(key, val) {
									$('.listBtnCharts').append('<tr id="chart'+val.id+'Row" value="0"></tr>')
									$('.listBtnCharts').find('tr:last').append('<td style="padding:5px 5px;"><button style="width:100%; text-transform: uppercase; white-space: normal; height: auto; margin: 2px 0" id="chart'+val.id+'Button" value="0" class="btnChart btn btn-info btn-md text-left" onclick="showBtnChart(\''+val.id+'\', \''+val.typeChart+'\', \''+val.basedQ+'\')"><i class="fa fa-eye"></i>'+val.buttonTitle+'</button></td>')
									$('.listBtnCharts').find('tr:last').append('<td style="padding:5px 5px;"><button style="width:100%;" id="chart'+val.id+'Edit" class="btn btn-success btn-md" onclick="changeOptChart(\''+val.id+'\', \'custom\', \'edit\', \''+val.title+'\')"><i class="fa fa-edit"></i></button></td>')
									$('.listBtnCharts').find('tr:last').append('<td style="padding:5px 5px;"><button style="width:100%;" id="chart'+val.id+'Remove" class="btn btn-warning btn-md" onclick="removeChart(\''+val.id+'\')"><i class="fa fa-trash"></i></button></td>')

									$('#chartResponses').append('<div class="cardChart col-md-'+val.cardCol+'" id="chart'+val.id+'Body" style="display:none;" name="0"><div class="card"><div class="card-body"><div class="chart"></div></div></div></div>')
									$('#chartResponses').find('.chart:last').append('<h2 align="center"><b>'+val.title+'</b></h2>')
									$('#chartResponses').find('.chart:last').append('<h5 align="center"><b>'+val.subtitle+'</b></h5><hr>')
									$('#chartResponses').find('.chart:last').append('<div class="row"></div>')
									$('#chartResponses').find('.chart:last .row:last').append('<div id="loadingChart'+val.id+'" style="display: none; margin: 100px auto;"></div>')
									for (let x = 0; x < 3; x++) {
										$('#chartResponses').find('.chart:last .row:last #loadingChart'+val.id+'').append('<div class="spinner-grow text-danger"></div>')
									}
									$('#chartResponses').find('.chart:last').append('<div style="height:500px" id="chart'+val.id+'"></div>')
								})
							},beforeSend: function(){
								$('#loadingListCharts').show()
							},complete: function() {
								if(idChart && typeChart && basedQ) showBtnChart(idChart, typeChart, basedQ)
								$('#loadingListCharts').hide()
  				    }
						})
					}

					// PREVIEW TYPE CHART --ir
					function showPreviewChart() {
						typeChart = $('#typeChart').val()
						if(typeChart){
							if($('#previewChart').val() == 0){
								$('#previewChart').val("1")
								$('#previewChart').removeClass("btn-info")
								$('#previewChart').addClass("btn-danger")
								$('#chartPreview').show()
								changePreviewChart(typeChart)
								
							}else{
								$('#previewChart').val("0")
								$('#previewChart').removeClass("btn-danger")
								$('#previewChart').addClass("btn-info")
								$('#chartPreview').hide()
							}
						}
					}

					function changePreviewChart(typeChart) {
						$.ajax({
							success  : function() {
								$('#chartPreview').empty()
								$('#chartPreview').append('<img src="<?php echo base_url() ?>assets/img/charts/'+typeChart+'.png" alt="" style="width:100%">')
							},beforeSend: function(){
								if($('#previewChart').val() == "1") {$('#chartPreview').empty(); $('#loadingChart').show()} 
							},complete: function() {
								$('#loadingChart').hide()
  				    }
						})
					}

					// CHANGE TYPE CHART --ir
					function changeTypeChart() {
						typeChart = $('#typeChart').val()
						if(typeChart) changePreviewChart(typeChart)
						$('.optChart').each(function() {
							$(this).hide()
						})
						if(typeChart == "GG1"){
							// $('#moreSeriesCol').empty()
							$('#optGauges').show()
						}else if(typeChart == "TAG1"){
							$('#optTag').show()
						}
					}
				
					// SET LISTS CHART --ir
					function getChartList(typeQ, currentChart) {
						$.ajax({
							url			 : '<?php echo base_url('General/dbResult') ?>',
							type 		 : 'post',
							dataType : 'JSON',
							data 	 	 : {table:"do_type_chart", column:"*", where:"1=1", order:""},
							success  : function(data) {
								typeQ = typeQ.replace("(","").replace(")","")
								$('#typeChart').find('option').remove().end().append('<option value="">Select Chart</option>')
								$.each(data, function(key, val) {
									id 		= val.chartType
									title = val.chartName
									comp  = val.chartComp
									if(!comp.includes(typeQ)) return true
									if(currentChart === id) $('#typeChart').append('<option selected value = '+id+'>' +title+'</option>')
  				        else $('#typeChart').append('<option value = '+id+'>' +title+'</option>')
								})
							},
							complete: function() {
								changeTypeChart() 
  				    } 
						})
					}

					// CALL MODAL UPDATE OPT TOTAL RESP --ir
					function changeOptChart(idChart, chart, act, title){
						$('#typeChart').val('').change()
						$('#basedQLists').val('').change()
						$('#idChart').val(idChart)
						$('#modalOptChart').show()
						if(chart == "main"){
							$('.customChartOpt').hide()
						}else{
							$('.customChartOpt').show()
						}
						$('#moreSeriesCol').empty()
						if(chart == "main") title = "Total Responden"
						else if(act == "create") title = "New"
						$('.modal-title').html("Option for "+title+" Chart")
						$('#modalOpt').val(chart)
						$('#actionOpt').val(act)
						if(act != "create") getDataOptChart()
					}

					// GET DATA OPT FOR TOT RESP GAUGES --ir
					function getDataOptChart() {
						var id = $('#id').val()
						var idChart = $('#idChart').val()
						var modalOpt = $('#modalOpt').val()
						if(modalOpt === "custom"){
							table = "do_charts"
							where = "id = '"+idChart+"'"
						}else{
							table = "do_surveys"
							where = "id = '"+id+"'"	
						}

						$.ajax({
							url : '<?php echo base_url('General/dbRow') ?>',
							type: "post",
							data: {table:table, column:"*", where:where, order:""},
							dataType: "JSON",
							success: function(data) {
								if(modalOpt !== "custom"){
									$('#typeChartMain').val(data.typeChart)
									$('#idQMain').val(data.basedQ)
								}else{
									$('#titleChart').val(data.title)
									$('#subtitleChart').val(data.subtitle)
									$('#buttonTitleChart').val(data.buttonTitle)
									$('#cardColChart').val(data.cardCol)
								}

								$('#typeChart').val(data.typeChart)
								$('#basedQLists').val(data.basedQ)
								$('#ansQLists').val(data.listAns)
								$('#maxTotResp').val(data.target)
								$('#jsonOptResp').empty()
								$('#jsonOptResp').append(data.opt)
								getQSurvey(id, data.basedQ, data.listAns, data.typeChart)
								if(data.typeChart == "GG1"){
									// $('#optChart1').show()
									$('#minTotResp').val(data.minResp)
									$('#moreSeriesCol').empty()
									optChart = JSON.parse(data.opt)
									$.each(optChart, function(key, object) {
										addSeriesChart("set")
										$('.moreSeries:last').val(object['title'])
										$('.moreMin:last').val(object['lowScore'])
										$('.moreMax:last').val(object['highScore'])
										$('.moreColor:last').val(object['color'])
									})
									$('.moreMax:last').val(data.target).prop("readonly", true)
									$('.moreMin:first').val(data.minResp).prop("readonly", true)
								}else if(data.typeChart == "TAG1"){
									$('#minTags').val(data.minResp)
								}
							}
						})
					}

					// SET BASED QUESTION FOR TOT RESP --ir
					function setBasedQ(idQ, listAns, chart) {
						$('#basedQ').attr("readonly", false)
						$('#basedQ').find('option').remove().end().append('<option value="">All Answers</option>')
						$.ajax({
  				    url 			: '<?php echo base_url('General/dbResult') ?>',
  				    type			: "post",
							data			: {table:"do_answers", column:"id, title, type", where:"question = '"+idQ+"'", order:""},
  				    dataType	: "JSON",
  				    success: function(data) {
  				      // REMOVE ALL OPTIONS --ir
  				      // APPEND RELVANT OPTIONS --ir
								$.each(data, function(key, val) {
									if(val.type === "line" || val.type === "paragraph"){
										$('#basedQ').attr("readonly", true)
										return false
									} 
									id 		= val.id
									title 	= val.title
									if(listAns){
											// alert(listAns)
										ans = listAns.split(",")
										$.each(ans, function(key, value) {
											if(value === title) $('#basedQ').append('<option value = '+id+'>' +title+'</option>')
											// else continue; 
										})
									}else $('#basedQ').append('<option value = '+id+'>' +title+'</option>')
								})
  						},	
  				    error: function() {
  				      swal({title : "Failed", text  : "Failed to load answers!", type	: "error"})
  				    }, 
  				    complete: function() {
								// changeTerminal()
								if($('#modalOptChart').is(":hidden")) getDataChart(chart, "", "chartTypeMain")
								// getDataChart(chart)
  				    } 
  				  })
					}

					// GET DATA TOT RESPONDENTS --ir
					function getDataChart(chart, custom, chartEl, idQ) {
						basedQ  = $('#basedQ').val()
						id 		  = $('#id').val()
						idChart = chartEl

						if(custom != "custom"){
							chart = $('#typeChartMain').val()
							idQ 	= $('#idQMain').val()
							showHideAllCharts('hide')
							$('.cardChart').each(function() {
								$(this).attr("name", "0")
							});
							chartEl 		 = "chartTypeMain"
							loadingChart = "loadingMainChart"
						}else{
							loadingChart = "loadingChart"+chartEl
							chartEl 		 = "chart"+chartEl
						}


						// GET VALUE RESPONDENS ON THIS TERMINAL --ir 
					  $.ajax({
							type: "POST",
					  	url: '<?php echo base_url().'SurveyLists/getDataChart/'; ?>',
  				    data: {basedQ:basedQ, id:id, idQ:idQ, idChart:idChart, chart:chart, custom:custom},
					  	dataType: "json",
					  	success: function(data) {
								if(chart == "GG1"){
									minResp = parseInt($('#minTotResp').val())
									maxResp = parseInt($('#maxTotResp').val())
									grades  = $('#jsonOptResp').html()
									console.log(grades)
									grades = JSON.parse(grades)
	
									var dataResp = {
										score: parseInt(data),
										gradingData: grades
									};
	
									gaugeBands(chartEl, dataResp, grades, minResp, maxResp)
								}else if(chart == "PIE1"){
									semiCirclePie(chartEl, data)
								}else if(chart == "PIE2"){
									radiusPie(chartEl, data)
								}else if(chart == "PIE3"){
									wholePie(chartEl, data)
								}else{
									wordCloud(chartEl, data)
								}
  				    },	
  				    error: function() {

  				    },beforeSend: function(){
							// alert(loadingChart+"show")

								$('#'+chartEl).hide()
								$('#'+loadingChart).show()
							},complete: function() {
								// alert(loadingChart+"hide")
								$('#'+loadingChart).hide()
								$('#'+chartEl).show()
  				    }
  				  });
					}

					// GET LIST QUESTION WITH RADIO TYPE --ir
					function getQSurvey(survey, question, listAns, chart) {
  				  $.ajax({
							url 			: '<?php echo base_url('General/dbResult') ?>',
  				    type			: "post",
							data			: {table:"do_questions", column:"id, title, type", where:"survey = '"+survey+"' AND type IN ('radio', 'line', 'paragraph')", order:""},
  				    dataType	: "JSON",
  				    success: function(data) {
								basedQLists = "#basedQLists"
  				      // REMOVE ALL OPTIONS --ir
  				      $(basedQLists).find('option').remove().end().append('<option value="">Select Questions</option>')
  				      // APPEND RELVANT OPTIONS --ir
								$.each(data, function() {
  				        id 			= this.id
  				        text 		= this.title
  				        type 		= this.type
  				        tokens 	= id+text
  				        tokens 	= tokens.replace(/ /g,'')
  				        if(question && question === id) $(basedQLists).append('<option selected data-tokens = "'+tokens+'" value = '+id+'>' +'('+type+') *** '+text+'</option>')
  				        else if(!(question)) $(basedQLists).append('<option selected data-tokens = "'+tokens+'" value = '+id+'>' +'('+type+') *** '+text+'</option>')
  				        else $(basedQLists).append('<option data-tokens = "'+tokens+'" value = '+id+'>' +'('+type+') *** '+text+'</option>')
									// $(basedQLists).find('option:last').append('<a class="qType" style="display:none" value="'+type+'"></a>')
								})

								if($('#modalOpt').val() !== "custom"){
									title = $(basedQLists+' :selected').html()
									title = title.split(" *** ")[1]
									$('#basedQTitle').empty()
									$('#basedQTitle').append('<b style="font-weight:900">'+title+'</b>')
									setBasedQ(question, listAns, chart)
								}
  						},	
  				    error: function() {
  				      swal({title : "Failed", text  : "Failed to load questions!", type	: "error"})
  				    }, 
  				    complete: function() {
								select()
  				      refreshSelect()
								changeBasedQLists($(basedQLists+' :selected').val(), listAns, chart)
  				    } 
  				  })
					}
					
					// GET LIST ANSWERS FROM QUESTIONS --ir
					function changeBasedQLists(idQ, listAns, chart) {
						typeQ = $('#basedQLists :selected').html().split(" *** ")[0]
						getChartList(typeQ, chart)

						ansQLists = "#ansQLists"
						$('.ansQTtext').html('');
						$('.ansQTtext').html("All the answers (you can remove some, but you can't add it!) : ");
						$(ansQLists).tagsinput('removeAll');
						if(listAns){
							$(ansQLists).tagsinput('add', listAns);
							return true
						}

						if(typeQ !== "(radio)"){
							$('.ansQTtext').html("Add Excluded Texts/Words/Tags");
							return false
						} 
						
  				  $.ajax({
  				    url : '<?php echo base_url('General/questionAnswers') ?>',
  				    type: "post",
  				    data: {idQ:idQ},
  				    dataType: "JSON",
  				    success: function(data) {
								$.each(data, function() {
									$(ansQLists).tagsinput('add', this.title);
								})
  						},	
  				    error: function() {
  				      swal({title : "Failed", text  : "Failed to load lists answers!", type	: "error"})
  				    }, 
  				    complete: function() {
  				    } 
  				  })
					}

					// ADDING SERIES TO GAUGES --ir
					function addSeriesChart(act) {
						resetMinMaxResp(act)
						countSeriesCount = 1
						seriesCount = $("input[class*='moreSeries']").length+1
						$('#moreSeriesCol').append('<tr class="form-inline rowSeries" id="rowSeries'+seriesCount+'"></tr>');
						// $('#moreSeriesCol').find('.rowSeries:last').append('<div class="form-group" style="width:100%"></div>');
						$('#moreSeriesCol').find('.rowSeries:last').append('<td style="width:40%; padding:5px 5px;"><input style="width:100%" type="text" id="titleSeries'+seriesCount+'" name="titleSeries'+seriesCount+'"  placeholder="Scale '+seriesCount+'" class="moreSeries form-control"></td>');
						$('#moreSeriesCol').find('.rowSeries:last').append('<td style="width:20%; padding:5px 5px;"><input style="width:100%" type="number" id="minSeries'+seriesCount+'" name="minSeries'+seriesCount+'" placeholder="Min" class="moreMin form-control"></td>');
						$('#moreSeriesCol').find('.rowSeries:last').append('<td style="width:20%; padding:5px 5px;"><input style="width:100%" type="number" id="maxSeries'+seriesCount+'" name="maxSeries'+seriesCount+'" placeholder="Max" class="moreMax form-control"></td>');
						$('#moreSeriesCol').find('.rowSeries:last').append('<td style="width:10%; padding:5px 5px;"><input style="width:100%; padding:2px 4px" type="color" id="colorSeries'+seriesCount+'" name="colorSeries'+seriesCount+'" placeholder="Max" class="moreColor form-control"></td>');
						$('#moreSeriesCol').find('.rowSeries:last').append('<td style="width:10%; padding:5px 5px;"><a style="heigth:100%; width:100%" id="btnRemoveSeries'+seriesCount+'" class="btn btn-danger btn-md" onclick="removeSeries(\''+seriesCount+'\')"><i class="fa fa-close" style="color:white"></i></a></td>');
						setMinMaxResp()
					}

					// ADJUST MIN RESP WHEN THERES ANY CHANGES ON MIN RESP --ir
					function changeMinChart() {
						resetMinMaxResp()
						min = $('#minTotResp').val()
						max = $('#maxTotResp').val()
						if(parseInt(min) >= parseInt(max)){
							swal("You can't!", "Minimum Respondent cannot be equal or bigger than Target Respondents", "warning");
							$('#minTotResp').val(0)
						}
						setMinMaxResp()
					}

					// RESET MIN ON FIRST SERIES AND MAX ON LAST SERIES -ir
					function resetMinMaxResp(act) {
						if(act){
							$('#moreSeriesCol .moreMin').first().prop("readonly", false)
							$('#moreSeriesCol .moreMax').last().prop("readonly", false)
						}else{
							$('#moreSeriesCol .moreMin').first().val('').prop("readonly", false)
							$('#moreSeriesCol .moreMax').last().val('').prop("readonly", false)
						} 
					}

					// SET MIN ON FIRST SERIES AND MAX ON LAST SERIES -ir
					function setMinMaxResp() {
						$('#moreSeriesCol .moreMin:visible').first().val($('#minTotResp').val()).prop("readonly", true)
						$('#moreSeriesCol .moreMax:visible').last().val($('#maxTotResp').val()).prop("readonly", true)
					}

					// REMOVE SELECTED SERIES --ir
					function removeSeries(no) {
						resetMinMaxResp()
						row = "#rowSeries"+no
						series = "#titleSeries"+no
						minSeries = "#minSeries"+no
						maxSeries = "#maxSeries"+no
						colorSeries = "#colorSeries"+no
						$(series, minSeries, maxSeries, colorSeries).val('')
						$(row).hide()
						setMinMaxResp()
					}

					// RESET ALL SERIES --ir
					function resetSeries() {
						if(!$.trim($('#moreSeriesCol').html())) { swal("There's nothing to reset!", "", "warning"); return false }
						swal({
							title 						 : "Hold on!",
							text 							 : "Are you sure to reset all these series?",
							type							 : "warning",
							showCancelButton 	 : true,
							confirmButtonClass : "btn-danger",
							confirmButtonText	 : "Yes, delete these!", 
							cancelButtonText	 : "No, nevermind!",
							closeOnConfirm		 : false,
							closeOnCancel			 : false
						},
						function(isConfirm) {
							if (isConfirm) {
								$('#moreSeriesCol').empty()
								swal("All Reset!", "", "success");
							}else{
								swal("Canceled", "", "success");
							}	
						});
					}
					
					// FUNCTION UPDATE OR ADD OPT TOTAL RESP --ir
      		function updateOptChart(){
						var id				 = $('#id').val()
						var idChart		 = $('#idChart').val()
						var typeChart  = $('#typeChart').val()
						var typeQ 		 = $('#basedQLists :selected').html().split(" *** ")[0].replace("(","").replace(")","")
						var basedQ		 = $('#basedQLists').val()
						var listAns		 = $('#ansQLists').val()
						var modalOpt	 = $('#modalOpt').val()
						var actionOpt	 = $('#actionOpt').val()

						var form 			= $('#formOptChart')[0]
						var formData 	= new FormData(form)
						formData.append('id', id)
						formData.append('idChart', idChart)
						formData.append('typeChart', typeChart)
						formData.append('basedQ', basedQ)
						formData.append('listAns', listAns)
						
						optChart = []
						if(typeChart == "GG1"){
							optChart = []
							var minResp		 = $('#minTotResp').val()
							formData.append('minResp', minResp)
							seriesCount = $("input[class*='moreSeries']").length
							formData.append('seriesCount', seriesCount)
							$('.rowSeries:visible').each(function() {
								seriesName = $(this).find('.moreSeries').val()
								minResp 	 = $(this).find('.moreMin').val()
								maxResp 	 = $(this).find('.moreMax').val()
								colorResp  = $(this).find('.moreColor').val()
								series = {
									title			: seriesName,
									color			: colorResp,
									lowScore	: parseInt(minResp),
									highScore	: parseInt(maxResp)
								} 
								optChart.push(series)
							})
						}else if(typeChart == "TAG1"){
							var minTags		 = $('#minTags').val()
							formData.append('minResp', minTags)
						}

						formData.append('modalOpt', modalOpt)
						formData.append('actionOpt', actionOpt)
						if(modalOpt == "main"){
							formData.append('table', 'do_surveys')
						}else{
							formData.append('table', 'do_charts')
							var maxResp		 = $('#maxTotResp').val()
							formData.append('maxResp', maxResp)
							formData.append('titleChart', $('#titleChart').val())
							formData.append('subtitleChart', $('#subtitleChart').val())
							formData.append('buttonTitleChart', $('#buttonTitleChart').val())
							formData.append('cardColChart', $('#cardColChart').val())
						}

						optChart = JSON.stringify(optChart, null, 2)
						formData.append('optChart', optChart)

						$.ajax({
      		    method		 	: "POST",
      		    dataType 		: "JSON",
      		    url 		 		: '<?php echo base_url('SurveyLists/updateOptChart') ?>',
							data 				: formData,
        			processData : false,
        			contentType : false,
        			cache 			: false,
      		    success  : function(data){
      		      if(data == 'success'){
									text  = "Success change option for total respondent gauges!";
									title = "Success"
      		      }else{
									text  = "Failed to change option for total respondent gauges!";
									title = "Warning"
      		      }
      		    },
      		    beforeSend: function(){
							
      		    },complete: function(){
								closeModalOptChart()
								swal({title : title, text  : text, type	: title.toLowerCase()},function () {
									if(modalOpt !== "custom"){
										getDataOptChart()
									} 
									if(modalOpt === "custom"){
										setChartCards(id, idChart, typeChart, basedQ)
										// showBtnChart(idChart, typeChart, basedQ)
									} 
								}) 
								// if(title==="Success") changePage()
      		    },
      		  });
      		}

					// CLOSE MODAL OPT TOTAL RESP --ir 
					function closeModalOptChart(){
						$('#idChart').val('')
						$('.optChart').each(function() {
							$(this).hide()
						})
						$('#titleChart').val('')
						$('#subtitleChart').val('')
						$('#buttonTitleChart').val('')
						$('#cardColChart').val('')
						$('#chartPreview').empty()

						$('#typeChart').val('').change()
						$('#basedQLists').val('').change()
						$('#minTotResp').val('')
						$('#actionOpt').val('')
						$('#modalOpt').val('')
      		  $('#modalOptChart').hide()
					}

					// // CONCERN DISCARD ALERT
					// var form = $('#formOptChart')
					// var origForm = form.serialize();

					// $('#formOptChart :input').on('change input', function() {
					// 	if(origForm !== form.serialize()) alert("Diff")
					// })

				// END - CHART MENU -- ir


			</script>
